# Add JavaScript required for your app (will be compressed together).
#= require highlightjs
#= require gist-async
#= require foundation/js/foundation/foundation
#= require foundation/js/foundation/foundation.clearing
#= require foundation/js/foundation/foundation.magellan
#= require foundation/js/foundation/foundation.reveal
# Require addtional foundation plugins above this line,
# or load everything by requiring foundation/js/foundation.

'use strict'

# Require JavaScript for responsive images.
<% case site.config['picture']['markup']
    when 'picturefill'
      require_asset 'picturefill'
    when 'interchange'
      require_asset 'foundation/js/foundation/foundation.interchange'
    end unless site.config['picture'].nil?
%>

# Invoke Foundation.
$(document).foundation()

# Invoke highlight.js on page load.
hljs.initHighlightingOnLoad()

# Set release download url.
$.get 'https://api.github.com/repos/<%= site.config['source_repo'] %>/releases',
  (data) ->
    tag = data[0].tag_name
    container = $("#download")
    container.attr "href", data[0].assets[0].browser_download_url
    container.fadeOut ->
      $(this).removeClass 'disabled'
      $(this).text("Get the overview pack (#{tag})").fadeIn()

    $.ajax "https://api.github.com/repos/<%= site.config['source_repo'] %>/contents/CHANGELOG.md?ref=#{tag}",
      headers: {Accept: 'application/vnd.github.v3.html'}
    .done (data) -> $('#changelog').replaceWith(data)
